---
title: "Group 2 work file"
author: "Yu, Eunice, Aditya"
date: "2023-03-23"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r import data, echo=FALSE, warning=FALSE}
library(knitr)
cwd <- dirname(rstudioapi::getSourceEditorContext()$path)
competition_data <- read.csv(paste(cwd, "competition-data.csv", sep = "/"))
head(competition_data)
```

```{r na value}
na_values <- sum(is.na(competition_data))
na_values
# Here the data has no N.A. value
```

```{r cor plot}
corr_matrix <- cor(competition_data)
sorted_corr_matrix <- sort(corr_matrix["outcome",], decreasing = TRUE)
top_10_variables <- names(sorted_corr_matrix)[2:11]
top_10_variables

# Here these are the 10 variables that are correlated to the outcome variable
# But this code only gives us the predictors that are positively co related, thus we decided not to go ahead with these predictors.
```
```{r library}
library(ggplot2)
library(dplyr)
library(tidyverse)

pairs(competition_data %>% dplyr::select(X1:X10, outcome))

pairs(competition_data %>% dplyr::select(X11:X21, outcome))

pairs(competition_data%>% dplyr::select(outcome, X2, X3, X4, X5, X9, X11, X15, X18, X19, X20, X21))
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(caret)
dplyr:::select.data.frame(competition_data, outcome)
df_predictors_only <- data.frame(competition_data)
Preprocessing_fit <- preProcess(
df_predictors_only,
method = c("BoxCox", "center", "scale"))
Preprocessing_fit
transformed_predictors <- predict(
Preprocessing_fit, df_predictors_only)
Processed_data<-cbind(transformed_predictors,Preprocess_data$outcome)
colnames(Processed_data)[4] <- "Yield"
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(earth)
library(Formula)
library(plotmo)
library(plotrix)
library(TeachingDemos)
set.seed(123)
ctrl = trainControl(
  method="cv", number = 10
)
```

#Linear Regression Model.
```{r}
set.seed(123)

lmTune <- train(outcome ~ ., data = Processed_data ,
                   method = "lm",
                   trControl = ctrl)
lmTune$results$RMSE

tooHigh <- findCorrelation(cor(train_x), .9)
trainXfiltered <- train_x[, -tooHigh]

lmTuneFiltered <- train(x = trainXfiltered, y = train_y,
                  method = "lm",
                  trControl = ctrl)
lmTuneFiltered$results$RMSE
```

# Ridge Regression Model.
```{r}
set.seed(100)
ridgeGrid <- expand.grid(lambda = seq(0, .1, length = 10))
ridgeTune <- train(outcome ~ ., data = Processed_data ,
                     method = "ridge",
                     tuneGrid = ridgeGrid,
                     trControl = ctrl,
                     preProc = c("center", "scale")
                )
```

```{r}
plot(ridgeTune)
ridgeTune$bestTune
min(ridgeTune$results$RMSE)
```

```{r}
set.seed(100)
  lassoGrid <- expand.grid(lambda = c(0), 
                        fraction = seq(.1, 1, length = 15))
  lassoTune <- train(outcome ~ ., data = Processed_data ,
                      method = "enet",
                      tuneGrid = lassoGrid,
                      trControl = ctrl,
                      preProc = c("center", "scale")
                    )
```

```{r}
plot(lassoTune)
lassoTune$bestTune
min(lassoTune$results$RMSE)
```

#LASSO.
```{r}
set.seed(100)
  lassoGrid <- expand.grid(lambda = c(0), 
                        fraction = seq(.1, 1, length = 15))
  lassoTune <- train(outcome ~ ., data = Processed_data ,
                      method = "enet",
                      tuneGrid = lassoGrid,
                      trControl = ctrl,
                      preProc = c("center", "scale")
                    )
```

```{r}
plot(lassoTune)
lassoTune$bestTune
min(lassoTune$results$RMSE)
```